var all_questions=[{question_string:"天空的顏色?",choices:{correct:"藍色",wrong:["粉紅色","橘色","綠色"]}},{question_string:"什麼季節最熱?",choices:{correct:"夏天",wrong:["冬天","秋天","春天"]}},{question_string:"三輪車有幾個輪子?",choices:{correct:"3",wrong:["1","2","4"]}},{question_string:"手機王的英文怎麼拚?",choices:{correct:"Sogi",wrong:["Gogi","Eogi","Gosi"]}}],Quiz=function(e){this.quiz_name=e,this.questions=[]},Question=(Quiz.prototype.add_question=function(e){var t=Math.floor(Math.random()*this.questions.length);this.questions.splice(t,0,e)},Quiz.prototype.render=function(e){var n=this,i=($("#quiz-results").hide(),$("#quiz-name").text(this.quiz_name),$("<div>").attr("id","question").insertAfter("#quiz-name"));function t(){n.questions[o].render(i),$("#prev-question-button").prop("disabled",0===o),$("#next-question-button").prop("disabled",o===n.questions.length-1);for(var e=!0,t=0;t<n.questions.length;t++)if(null===n.questions[t].user_choice_index){e=!1;break}$("#submit-button").prop("disabled",!e)}var o=0;t(),$("#prev-question-button").click(function(){0<o&&(o--,t())}),$("#next-question-button").click(function(){o<n.questions.length-1&&(o++,t())}),$("#submit-button").click(function(){for(var e=0,t=0;t<n.questions.length;t++)n.questions[t].user_choice_index===n.questions[t].correct_choice_index&&e++;var i=e/n.questions.length;console.log(i),i=1==i?"Great job!":.75<=i?"You did alright.":.5<=i?"Better luck next time.":"Maybe you should try a little harder.",$("#quiz-results-message").text(i),$("#quiz-results-score").html("你答對了 <b>"+e+"/"+n.questions.length+"</b> 個問題"),$("#quiz-results").slideDown(),$("#quiz button").slideUp()}),i.bind("user-select-change",function(){for(var e=!0,t=0;t<n.questions.length;t++)if(null===n.questions[t].user_choice_index){e=!1;break}$("#submit-button").prop("disabled",!e)})},function(e,t,i){this.question_string=e,this.choices=[],this.user_choice_index=null,this.correct_choice_index=Math.floor(Math.random()*i.length+1);for(var n,o=i.length+1,s=0;s<o;s++)s===this.correct_choice_index?this.choices[s]=t:(n=Math.floor(Math.random(0,i.length)),this.choices[s]=i[n],i.splice(n,1))});Question.prototype.render=function(i){var n=this,e=0===i.children("h2").length?$("<h2>").appendTo(i):i.children("h2").first();e.text(this.question_string),0<i.children("input[type=radio]").length&&i.children("input[type=radio]").each(function(){var e=$(this).attr("id");$(this).remove(),i.children("label[for="+e+"]").remove()});for(var t=0;t<this.choices.length;t++)$("<input>").attr("id","choices-"+t).attr("type","radio").attr("name","choices").attr("value","choices-"+t).attr("checked",t===this.user_choice_index).appendTo(i),$("<label>").text(this.choices[t]).attr("for","choices-"+t).appendTo(i);$("input[name=choices]").change(function(e){var t=$("input[name=choices]:checked").val();n.user_choice_index=parseInt(t.substr(t.length-1,1)),i.trigger("user-select-change")})},$(document).ready(function(){for(var e=new Quiz("問答題"),t=0;t<all_questions.length;t++){var i=new Question(all_questions[t].question_string,all_questions[t].choices.correct,all_questions[t].choices.wrong);e.add_question(i)}var n=$("#quiz");e.render(n)});